\begin{document}

    \begin{tikzpicture}
        \umlclass[x=0, y=0]{FuseWrapper}{
            + static struct fuse\_operations ops
        }{
            + virtual int getattr(const std::string \&pathname, struct stat *buf) \\
            + virtual int write(const std::string \&pathname, const char *buf, size_t count, off\_t offset, struct fuse\_file\_info *fi) \\
            + virtual int open(const std::string \&pathname, struct fuse\_file\_info *fi) \\
            + virtual int read(const std::string \&pathname, char *buf, size_t count, off\_t offset, struct fuse\_file\_info *fi) \\
            + virtual int main(int argc, char *argv[]) \{ return fuse\_main(argc, argv, \&ops, this); \} \\
            + \ldots
        }

        \umlclass[x=0, y=-5]{CustomVfs}{
            -- std::string mountpoint \\
            -- std::string backing\_dir
        }{
            + int getattr(const std::string \&pathname, struct stat *buf) \\
            + int write(const std::string \&pathname, const char *buf, size_t count, off\_t offset, struct fuse\_file\_info *fi) \\
            + int open(const std::string \&pathname, struct fuse\_file\_info *fi) \\
            + int read(const std::string \&pathname, char *buf, size_t count, off\_t offset, struct fuse\_file\_info *fi) \\
            + int main(int argc, char *argv[]) \\
            + \ldots
        }

        \umlclass[x=0, y=-10]{VfsDecorator}{
            -- CustomVfs\& wrapped\_vfs
        }

        \umlclass[x=-2, y=-14]{EncryptionVfs}{
        }{
            + int write(const std::string \&pathname, const char *buf, size_t count, off\_t offset, struct fuse\_file\_info *fi) \\
            + int read(const std::string \&pathname, char *buf, size_t count, off\_t offset, struct fuse\_file\_info *fi)
        }
        {
            \begin{umlcompartment}{Private Operations}
                + bool encrypt(const std::string \&pathname, const std::string \&password) \\
                + bool decrypt(const std::string \&pathname, const std::string \&password) \\
                + \ldots
            \end{umlcompartment}
        }

        \umlclass[x=2, y=-14]{VersioningVfs}{
        }{
            + int write(const std::string \&pathname, const char *buf, size_t count, off\_t offset, struct fuse\_file\_info *fi) \\
            + int read(const std::string \&pathname, char *buf, size_t count, off\_t offset, struct fuse\_file\_info *fi) \\
            + \ldots
        }
        {
            \begin{umlcompartment}{Private Operations}
                + int handle\_hook(const std::string \&pathname, const char *buf, size\_t count, off\_t offset, struct fuse\_file\_info *fi) \\
                + bool remove\_version(const std::string \&pathname, int \&version) \\
                + \ldots
            \end{umlcompartment}
        }

        \umlinherit{CustomVfs}{FuseWrapper}
        \umlinherit{VfsDecorator}{CustomVfs}
        \umlinherit{EncryptionVfs}{VfsDecorator}
        \umlinherit{VersioningVfs}{VfsDecorator}
    \end{tikzpicture}


\end{document}